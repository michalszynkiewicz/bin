<!DOCTYPE html>
<!-- saved from url=(0048)http://localhost:4000/blog/smallrye-stork-intro/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Quarkus - SmallRye Stork meets Quarkus</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-Content-Security-Policy" content="default-src https://dpm.demdex.net; script-src &#39;self&#39; &#39;unsafe-eval&#39; &#39;sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=&#39; &#39;sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=&#39; js.bizographics.com https://www.redhat.com https://static.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com https://app.mailjet.com http://www.youtube.com http://www.googleadservices.com https://googleads.g.doubleclick.net https://dpm.demdex.net; style-src &#39;self&#39; https://fonts.googleapis.com https://use.fontawesome.com; img-src &#39;self&#39; *; media-src &#39;self&#39;; frame-src https://www.googletagmanager.com https://www.youtube.com https://embed.restream.io https://app.mailjet.com; base-uri &#39;none&#39;; object-src &#39;none&#39;; form-action &#39;none&#39;; font-src &#39;self&#39; https://use.fontawesome.com https://fonts.gstatic.com;">
  <script type="text/javascript" async="" src="./Quarkus - SmallRye Stork meets Quarkus_files/insight.min.js"></script><script type="text/javascript" async="" src="./Quarkus - SmallRye Stork meets Quarkus_files/f.txt"></script><script type="text/javascript" async="" src="./Quarkus - SmallRye Stork meets Quarkus_files/analytics.js"></script><script async="" src="./Quarkus - SmallRye Stork meets Quarkus_files/gtm.js"></script><script async="" src="./Quarkus - SmallRye Stork meets Quarkus_files/gtm(1).js"></script><script id="adobe_dtm" src="./Quarkus - SmallRye Stork meets Quarkus_files/dtm.js" type="text/javascript"></script><script src="./Quarkus - SmallRye Stork meets Quarkus_files/AppMeasurement.min.js" async=""></script><script src="./Quarkus - SmallRye Stork meets Quarkus_files/AppMeasurement_Module_ActivityMap.min.js" async=""></script><script src="./Quarkus - SmallRye Stork meets Quarkus_files/rh.mktg.js"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/highlight.pack.js" type="text/javascript"></script>
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="http://localhost:4000/blog/smallrye-stork-intro/">
  <meta property="og:title" content="SmallRye Stork meets Quarkus">
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java">
  <meta property="og:image" content="http://localhost:4000/assets/images/quarkus_card.png">
  
  <link rel="canonical" href="http://localhost:4000/blog/smallrye-stork-intro/">
  <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.ico">
  <link rel="stylesheet" href="./Quarkus - SmallRye Stork meets Quarkus_files/config.css">
  <link rel="stylesheet" href="./Quarkus - SmallRye Stork meets Quarkus_files/main.css">
  <link rel="stylesheet" href="./Quarkus - SmallRye Stork meets Quarkus_files/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml" href="http://localhost:4000/feed.xml" title="Quarkus">
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/goan.js" type="text/javascript"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/hl.js" type="text/javascript"></script>
<script src="./Quarkus - SmallRye Stork meets Quarkus_files/f(1).txt"></script></head>

<body class="post" cz-shortcut-listen="true">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  

<div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox">
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
      
        <a href="http://localhost:4000/"><img src="./Quarkus - SmallRye Stork meets Quarkus_files/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
      
    </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <div id="menu" class="menu" style="">
      <span>
        <a href="http://localhost:4000/get-started/" class="">Get Started</a>
      </span>
      <span>
        <a href="http://localhost:4000/guides/" class="">Guides</a>
      </span>
      <span>
        <a href="http://localhost:4000/community/" class="">Community</a>
      </span>
      <span>
        <a href="http://localhost:4000/support/" class="">Support</a>
      </span>
      <span>
        <a href="http://localhost:4000/blog/" class="active">Blog</a>
      </span>
      <span>
        <a href="https://code.quarkus.io/" class="button-cta secondary white">Start Coding</a>
      </span>
    </div>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    <div class="post-page grid-wrapper">
  <div class="width-8-12 width-12-12-m doc-content">
    <div class="grid-wrapper">
      <div class="width-12-12">
        <p>
          <a href="http://localhost:4000/blog"><i class="fas fa-angle-left"></i> Back to all posts</a>
        </p>
      </div>
      <div class="width-12-12">
        <div class="post-date">
          November 23, 2021 
          
            <span class="tags"><a href="http://localhost:4000/blog/tag/extension">#extension</a><a href="http://localhost:4000/blog/tag/smallrye-stork">#smallrye-stork</a></span>
          
        </div>
        <h1 class="post-title">SmallRye Stork meets Quarkus</h1>
        <div class="grid-wrapper">
          <div class="width-8-12 width-12-12-m byline-wrapper">
            
            
              <img class="headshot" src="./Quarkus - SmallRye Stork meets Quarkus_files/56bb9db102d84c3cf9656564445fc1f0.jpeg">
            
            <p class="byline">By Michał Szynkiewicz</p>
          </div>
          <div class="width-12-12">
              <div class="paragraph">
<p>Last week, the Quarkus Insights spotlighted a new project called SmallRye Stork and its integration in Quarkus. In this blog post, we’re going to give you a concise introduction to Stork.</p>
</div>
<div class="sect1">
<h2 id="whats-the-problem"><a class="anchor" href="http://localhost:4000/blog/smallrye-stork-intro/#whats-the-problem"></a>What’s the problem?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nowadays, systems we build consist of numerous applications, often called microservices. The system’s overall behavior emerges from the interactions between all these services. So, a microservice is likely going to invoke other ones. But here is the catch. In dynamic environments, such as Kubernetes, or the Cloud, the locations of these services may change over time. So, how does our microservice locate the services it needs to call?</p>
</div>
<div class="paragraph">
<p>Service discovery solves that problem, as it provides a mechanism to register and find the services. But it leads to another issue. What happens when there are multiple instances of the same service? How does a microservice select the right one? This scenario typically occurs when there are multiple replicas or versions available at the same time. Thus, in addition to service discovery, we need a way to select the right one.</p>
</div>
<div class="paragraph">
<p>Some environments, e.g., Kubernetes, provide ways to discover service locations and load-balance the traffic. Some do not. In some cases, the capabilities of the environment are not sufficient for the needs of the system.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="./Quarkus - SmallRye Stork meets Quarkus_files/stork.png" alt="SmallRye Stork" width="60%">
</div>
</div>
<div class="paragraph">
<p>To address these issues, we have created <a href="https://smallrye.io/smallrye-stork">SmallRye Stork</a>. Stork provides both features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>service discovery - it lets you locate the service you need to call;</p>
</li>
<li>
<p>service selection - it lets you select the right one when there is more than one instance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-stork"><a class="anchor" href="http://localhost:4000/blog/smallrye-stork-intro/#what-is-stork"></a>What is Stork?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SmallRye Stork is a <em>service discovery and client-side load-balancing framework</em>.</p>
</div>
<div class="paragraph">
<p>Out of the box, it provides integrations with Hashicorp Consul, Eureka, and Kubernetes and brings in a couple of load-balancer (handling the service selection) implementations, such as round-robin. But the most significant strength of Stork is its extensibility. You can plug your own service discovery mechanism or implement your own, maybe business-related, service selection strategy.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="stork-and-quarkus"><a class="anchor" href="http://localhost:4000/blog/smallrye-stork-intro/#stork-and-quarkus"></a>Stork and Quarkus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As of Quarkus 2.5.0.Final, Quarkus gRPC and the Quarkus Reactive REST Client can use Stork to handle the discovery and the selection of the services.</p>
</div>
<div class="paragraph">
<p>You just need to configure how you want to locate and select your services and add the related implementation, and the rest will be handled by the clients directly.</p>
</div>
<div class="paragraph">
<p>For example, to use Stork to determine the actual address for REST Client Reactive, set the scheme of your client’s URI to <code>stork</code>, and the hostname of the URI to the name of the Stork service. If your client’s <code>configKey</code> is <code>my-client</code>, to use it with Hashicorp Consul and the <code>round-robin</code> load balancer, put the following in your `application.properties:</p>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-property hljs" data-lang="property">quarkus.rest-client.my-client.uri=stork://hello-service

stork.hello-service.service-discovery=consul
stork.hello-service.service-discovery.consul-host=&lt;consul host&gt;
stork.hello-service.service-discovery.consul-port=&lt;consul port&gt;

stork.hello-service.load-balancer=round-robin</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="http://smallrye.io/smallrye-stork/1.0.0.Beta1/quarkus/">project’s documentation</a> describes step by step how to use Stork with the REST Client, using Consul and round-robin load balancer as examples.</p>
</div>
<div class="paragraph">
<p>Service selection can be pretty advanced. For instance, the least-response-time strategy monitors the service calls to select the <em>fastest</em> service instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In Quarkus 2.5, the gRPC extension does not propagate statistics of the calls, such as response time or encountered errors. Therefore, a load balancer that relies on this data, such as least-response-time, will not work correctly. We are working on it and hope to have it in Quarkus 2.6.
</td>
</tr>
</tbody></table>
</div>
<div class="sect2">
<h3 id="demo-and-a-lot-more"><a class="anchor" href="http://localhost:4000/blog/smallrye-stork-intro/#demo-and-a-lot-more"></a>Demo and a lot more!</h3>
<div class="paragraph">
<p>Take a look at the <a href="https://www.youtube.com/watch?v=l3mLKU3wR2A">70th episode of Quarkus Insights</a> for a more detailed explanation and examples. The demo used <a href="https://github.com/michalszynkiewicz/rest-client-reactive-stork">this project</a> as the client-side, each of the steps has a corresponding commit in the main branch. The backend services were instances of <a href="https://github.com/michalszynkiewicz/configurable-rest-service">this project</a>, and the custom service discovery server implementation can be found <a href="https://github.com/michalszynkiewicz/simple-service-discovery-server">here</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="http://localhost:4000/blog/smallrye-stork-intro/#conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This post briefly introduces SmallRye Stork and its Quarkus integration. Stork provides a way to locate and select services. It’s simple and customizable.
We will cover Stork features in more detail shortly.</p>
</div>
<div class="paragraph">
<p>If you have ideas for new features, or encounter a bug, please let us know by creating a <a href="https://github.com/smallrye/smallrye-stork/issues">GitHub issue</a>.</p>
</div>
</div>
</div>
              
          </div>
          <div class="width-12-12"><div class="share-page">
  <a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://localhost:4000/blog/smallrye-stork-intro/&amp;title=SmallRye%20Stork%20meets%20Quarkus" rel="nofollow" target="_blank" title="Share on LinkedIn">
    <img src="./Quarkus - SmallRye Stork meets Quarkus_files/icons_social-linkedin.png">
  </a>
  <a class="share-twitter" href="https://twitter.com/intent/tweet?text=SmallRye%20Stork%20meets%20Quarkus&amp;url=http://localhost:4000/blog/smallrye-stork-intro/&amp;via=quarkusio&amp;related=quarkusio" rel="nofollow" target="_blank" title="Share on Twitter">
    <img src="./Quarkus - SmallRye Stork meets Quarkus_files/icons_social-twitter.png">
  </a>
  <a class="share-facebook" href="https://facebook.com/sharer.php?u=http://localhost:4000/blog/smallrye-stork-intro/" rel="nofollow" target="_blank" title="Share on Facebook">
    <img src="./Quarkus - SmallRye Stork meets Quarkus_files/icons_social-facebook.png">
  </a>
  <a class="share-reddit" href="http://www.reddit.com/submit?url=http://localhost:4000/blog/smallrye-stork-intro/" onclick="window.open(this.href, &#39;pop-up&#39;, &#39;left=20,top=20,width=900,height=500,toolbar=1,resizable=0&#39;); return false;" title="Share on Reddit">
    <img src="./Quarkus - SmallRye Stork meets Quarkus_files/icons_social-reddit.png">
  </a>
  <a class="share-email" href="mailto:?subject=SmallRye%20Stork%20meets%20Quarkus&amp;body=SmallRye%20Stork%20meets%20Quarkus%20http://localhost:4000/blog/smallrye-stork-intro/" title="Share via Email">
    <img src="./Quarkus - SmallRye Stork meets Quarkus_files/icons_social-email.png">
  </a>
</div>
</div>
        </div>
      </div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="http://localhost:4000/"><img src="./Quarkus - SmallRye Stork meets Quarkus_files/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache Software License 2.0</a> or compatible license.<br><br>This website was built with <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>, is hosted on <a href="https://pages.github.com/" target="_blank">Github Pages</a> and is completely open source. If you want to make it better, <a href="https://github.com/quarkusio/quarkusio.github.io" target="_blank">fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
            <li><a href="http://localhost:4000/">Home</a></li>
          
            <li><a href="http://localhost:4000/guides">Guides</a></li>
          
            <li><a href="http://localhost:4000/community/#contributing">Contribute</a></li>
          
            <li><a href="http://localhost:4000/faq">FAQ</a></li>
          
            <li><a href="http://localhost:4000/get-started">Get Started</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Contribute</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Follow us</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
            <li><a href="http://localhost:4000/security">Security&nbsp;policy</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://quarkusio.zulipchat.com/">Chat room</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">Development mailing list</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io/" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org/" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io/" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io/" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org/" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io/" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="./Quarkus - SmallRye Stork meets Quarkus_files/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="./Quarkus - SmallRye Stork meets Quarkus_files/mobile-nav.js"></script>
  <script type="text/javascript" src="./Quarkus - SmallRye Stork meets Quarkus_files/scroll-down.js"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/satellite.js" type="text/javascript"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/config.js" type="text/javascript"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/search-filter.js" type="text/javascript"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="./Quarkus - SmallRye Stork meets Quarkus_files/back-to-top.js" type="text/javascript"></script>



        <script type="text/javascript" id="">_bizo_data_partner_id="6570";</script>
<script type="text/javascript" id="">(function(){var b=document.getElementsByTagName("script")[0],a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===window.location.protocol?"https://sjs":"http://js")+".bizographics.com/insight.min.js";b.parentNode.insertBefore(a,b)})();</script>
<noscript>
  <img height="1" width="1" alt="" style="display:none;" src="//www.bizographics.com/collect/?pid=6570&amp;fmt=gif">
</noscript></body></html>